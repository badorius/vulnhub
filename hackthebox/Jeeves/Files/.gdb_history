exit
start
r < exploit.bin
c
quit
start
run
/opt/metasploit/tools/exploit/pattern_offset.rb -q 5555555552ae -l 200
quit
start
list 
list main
disassemble main
break main
r < exploit.bin
run
run
r < exploit.bin
quit
start
r < exploit.bin
r < exploit.bin
r < jeeves_payload 
quit
start
r
quit
start
disassemble 
info r rbp-0x4
info r rbp
list
itrace 
less -r peda-trace-jeeves.txt
ls -lrt
info
info functions 
info main
info rbp
info registers 
start
info registers 
quit
start
start
run
exit
start
disassemble 
show 55555555522c
x/xw 55555555522c
x/xw 0x000055555555522c
x/xw 0x0000555555555231
i r 0x0000555555555231
i re rbp-0x4
i re +77
i re 0x0000555555555236
i a 0x0000555555555236
i address 0x0000555555555236
break +72
break 
i a 0x00005555555551fc
x/xw 0x00005555555551fc
i r 0x053d8d48
x/xw 0x053d8d48
x/xw 0x000055555555521e
start
disassemble 
i address 8
info address 0x00005555555551f5
info address 0x00005555555551f5
info address 5555555551f5
info address 001011f5
info address 5555555551f5
info registers 5555555551f5
x/xg 0x00005555555551f5
info register 0x48deadc0d3fc45c7
quit
start
break main
run
n
n
n
n
n
n
n
n
n
start
disassemble 
quit
start
pattern create 64
run
start
break main
n
n
n
n
n
n
n
n
n
disassemble 
pattern offset ?
pattern offset 0x00005555555551f5
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAH
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHa
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHaaaa
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AA
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2A
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAA
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)A
pattern offset AAA%AAsAABAA$AAnAAC
pattern offset AAA%AAsAA
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHaaaa
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAH
AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAH
n
n
n
n
n
n
n
n
n
n
n
n
n
start
n
n
n
n
n
n
n
n
n
quit
start
r
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AA
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAa
pattern offset AAA%AAsAABAA$AAn
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAaa
pattern offset AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAa
quit
start
disassemble 
pattern offset 0x00005555555551f5
pattern offset 0x5555555551f5
pattern offset 0x000055555555521e
pattern offset 0x55555555521e
quit
start
pattern_create 64
run
s
start
break main
run
run
n
n
n
n
n
n
n
n
n
exit
start
break main
pattern_create 72
n
n
n
n
n
n
n
n
n
exit
start
n
n
n
n
n
n
n
n
n
exit
pattern_search 
pattern_search ?
pattern_search 0x00005555555551f5
pattern_search 0x00005555555551f5
start
pattern_search 0x00005555555551f5
pattern_search 0x5555555551f5
n
pattern_search 
pattern_search 0x00005555555551f5
i x/x rbp-0x4
set rbp-0x4 rbp-0x4
set var local_c=0x1337bab3
file 
file jeeves
set var local_c=0x1337bab3

ls 
ls -lrt
start
n
mov    DWORD PTR [rbp-0x4],0x1337bab3
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
quit
break *0x0000555555555236
run
x/s 0x555555555236
x/s rbp-0x4
x/s $rbp-0x4
quit
break *0x0000555555555236
run
 x/s $rbp-0x4
quit
